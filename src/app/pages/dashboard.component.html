<!-- USER PROFILE -------------------------------------------------- -->
<div class="row g-4 mb-4">
  <div class="col-lg-8 col-xl-6 mx-auto">
    <div class="card-lite p-4">
      <h5 class="section-title mb-3">Your profile</h5>

      <form class="row g-3">
        <!-- gross salary -->
        <div class="col-md-6">
          <label class="form-label small">Gross annual salary (â‚¬)</label>
          <input type="number"
                 class="form-control"
                 [ngModel]="state.gross$ | async"
                 name="gross"
                 (ngModelChange)="state.setGrossAnnual($event)">
        </div>

        <!-- savings goal -->
        <div class="col-md-6">
          <label class="form-label small">Monthly savings goal (â‚¬)</label>
          <input type="number"
                 class="form-control"
                 [ngModel]="state.savings$ | async"
                 name="savings"
                 (ngModelChange)="state.setSavings($event)">
        </div>
      </form>
    </div>
  </div>
</div>

<!-- MAP + CHART ROW ---------------------------------------------- -->
<div class="row g-4">
  <!-- map -->
  <div class="col-12 col-lg-6">
    <div class="card-lite">
      <app-map></app-map>
    </div>
  </div>

  <!-- chart / placeholder -->
  <div class="col-12 col-lg-6">
    <div class="card-lite p-4 h-100 d-flex flex-column">

      <!-- when no city yet -->
      <ng-container *ngIf="!(vm$ | async); else chartBlock">
        <div class="d-flex flex-grow-1 align-items-center justify-content-center text-muted">
          <em>Select a city marker&nbsp;to see the comparison.</em>
        </div>
      </ng-container>

      <!-- real chart + summary -->
      <ng-template #chartBlock>
        <ng-container *ngIf="vm$ | async as vm">
          <h5 class="section-title mb-3">{{ vm.cityName }} â€“ salary comparison</h5>

          <div class="chart-wrapper flex-grow-1">
            <app-salary-chart
              [current]="vm.currentNet"
              [required]="vm.requiredNet">
            </app-salary-chart>
          </div>

          <p class="mt-3 fs-6">
            To keep saving <strong>{{ state.savings$ | async }} â‚¬</strong>
            each month in <strong>{{ vm.cityName }}</strong>, you would need
            <strong>{{ vm.requiredNet | number:'1.0-0' }} â‚¬ net</strong>.
            <span *ngIf="vm.requiredNet !== vm.currentNet">
              That is
              <span [class.text-danger]="vm.requiredNet > vm.currentNet"
                    [class.text-success]="vm.requiredNet < vm.currentNet">
                {{ (vm.requiredNet - vm.currentNet) | number:'1.0-0' }} â‚¬
              </span>
              {{ vm.requiredNet > vm.currentNet ? 'more' : 'less' }}
              than your current net salary.
            </span><br>
            <span class="small text-muted">
              â‰ˆ {{ vm.requiredGrossAnnual | number:'1.0-0' }} â‚¬ gross per year in {{ vm.cityName }}.
            </span>
          </p>
        </ng-container>
      </ng-template>

    </div>
  </div>
</div>

<!-- INFO BAR ------------------------------------------------------ -->
<div class="row g-4 mt-4">
  <div class="col-lg-8 col-xl-6 mx-auto">
    <div class="card-lite p-3 text-center">
      <span class="fw-semibold">Reference city:</span> Mannheim&nbsp;ðŸ‡©ðŸ‡ª |
      <span class="fw-semibold">Gross annual salary:</span>
      {{ state.gross$ | async | number:'1.0-0' }} â‚¬
    </div>
  </div>
</div>
